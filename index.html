<div class="island-container">
  <div id="island" class="dynamic-island" onclick="openIsland()">
    <div class="island-minimized">
      <span class="material-icons-round" style="color: #1DB954; font-size: 20px;">spotify</span>
      <span style="font-size: 13px; font-weight: 800;">Spotify</span>
    </div>

    <div class="island-expanded">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
        <span style="font-size: 10px; color: #1DB954; font-weight: 900; letter-spacing: 1px;">SPOTIFY PLAYER</span>
        <span class="material-icons-round" onclick="closeIsland(event)" style="font-size: 18px; cursor: pointer; color: #666;">close</span>
      </div>
      
      <div style="display: flex; gap: 6px; margin-bottom: 10px;">
        <button class="track-mini-btn active" id="t1" onclick="switchSpotify('0VjIj97zuo7Y6Z9C9Sdw9T', 1, event)">Трек 1</button>
        <button class="track-mini-btn" id="t2" onclick="switchSpotify('4S98698S76813687368', 2, event)">Альбом 2</button>
      </div>

      <div id="spotify-container" style="width: 100%; height: 80px; background: #000; border-radius: 12px; overflow: hidden;">
        <iframe id="spotify-frame" 
                src="https://open.spotify.com/embed/track/0VjIj97zuo7Y6Z9C9Sdw9T?utm_source=generator&theme=0" 
                width="100%" 
                height="80" 
                frameBorder="0" 
                allowfullscreen="" 
                allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
                loading="lazy">
        </iframe>
      </div>
    </div>
  </div>
</div>

<script>
  // Оновлена функція перемикання Spotify
  function switchSpotify(trackId, btnNum, e) {
    e.stopPropagation();
    const frame = document.getElementById('spotify-frame');
    const b1 = document.getElementById('t1');
    const b2 = document.getElementById('t2');
    
    // Оновлюємо src на правильний формат embed
    frame.src = `https://open.spotify.com/embed/track/${trackId}?utm_source=generator&theme=0`;
    
    // Перемикаємо активні класи кнопок
    if(btnNum === 1) {
      b1.classList.add('active');
      b2.classList.remove('active');
    } else {
      b2.classList.add('active');
      b1.classList.add('active'); // Виправлено візуальний баг
      b1.classList.remove('active');
      b2.classList.add('active');
    }
  }

  // Додай це, щоб острів не глючив при відкритті
  function openIsland() {
    const island = document.getElementById('island');
    if (!island.classList.contains('active')) {
      island.classList.add('active');
      // Невеликий хак для перемальовування iframe (фіксить порожній екран)
      const frame = document.getElementById('spotify-frame');
      frame.src = frame.src; 
    }
  }
</script>
